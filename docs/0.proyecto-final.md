```
Universidad del Quindío  
Programa de Ingeniería de Sistemas y Computación  
Programación III - Proyecto Final  
Docente: Carlos Andrés Flórez V.
```

# 🎮 Proyecto Final – Trivia Multijugador en Elixir

## 📌 Descripción General

Se debe implementar un **juego multijugador en línea de preguntas y respuestas**.

Varios usuarios se conectan en tiempo real a través de la **línea de comandos (CLI)**, y el sistema gestiona partidas independientes con sus propias preguntas.

El objetivo es acumular la mayor cantidad de puntos respondiendo correctamente.

---

## 🎯 Objetivos de Aprendizaje

* Aplicar conceptos de **concurrencia y procesos** en Elixir.
* Diseñar e implementar sistemas distribuidos mediante **GenServers** y **Supervisores dinámicos**.
* Manejar **persistencia de datos** en archivos de texto plano.
* Construir un sistema interactivo en tiempo real con manejo de **usuarios, partidas y ranking**.

---

## ✅ Funcionalidades Requeridas

### 1. Gestión de Usuarios

* Registro y login de jugadores.
* Usuarios almacenados en `users.dat` (nombre, contraseña, puntaje acumulado).
* Consultar puntaje propio (`score`).
* Ranking histórico global, con opción de filtrar por tema.

### 2. Conexión al Servidor

* Conectarse (`connect username password`).

  * Si el usuario no existe → se registra automáticamente.
* Desconectarse (`disconnect`).
* Consultar lista de partidas disponibles (`list_games`).

### 3. Concurrencia

* Varios usuarios pueden conectarse simultáneamente.
* Cada partida es un proceso independiente implementado con **GenServer**.
* Múltiples partidas pueden ejecutarse en paralelo bajo un **DynamicSupervisor**.

### 4. Gestión de Partidas

* Crear partida (`create_game tema=ciencia preguntas=5 tiempo=15s`).
* Unirse a una partida (`join_game game_id`).
* Cada partida tiene un máximo de jugadores (ej. 4).
* Una vez iniciada o llena, no admite más jugadores.
* El creador puede iniciar la partida (`start_game`).
* El sistema envía preguntas a todos los jugadores en la partida.

### 5. Dinámica del Juego

* Las preguntas se seleccionan aleatoriamente de `questions.dat`, filtradas por tema.
* El servidor envía una pregunta a todos los jugadores con un temporizador (ej. 15 segundos).
* Los jugadores responden (`answer 1 B`).
* Reglas de puntaje:

  * +10 puntos por respuesta correcta.
  * –5 puntos por respuesta incorrecta.
* Solo se valida la **primera respuesta enviada** por cada jugador.

### 6. Resultados y Ranking

* Al terminar las rondas, el sistema muestra un ranking de la partida.
* Se guarda en `results.log` el historial: fecha, tema, ganador y puntajes finales.
* Se actualiza el puntaje acumulado de los jugadores en `users.dat`.

### 7. Persistencia

* **users.dat** → usuarios y puntajes acumulados.
* **results.log** → historial de partidas (texto plano).
* **questions.dat** → banco de preguntas clasificadas por tema.
* Formato recomendado: **CSV o JSON**, simple y editable.

### 8. Concurrencia y Tiempo Real

* Soporte para múltiples jugadores conectados.
* Temporizador por cada pregunta.
* Al expirar el tiempo: se anuncia la respuesta correcta y se pasa a la siguiente pregunta.
* Las partidas son **independientes y no interfieren entre sí**.

---

## ⚙️ Tecnologías y Conceptos de Elixir

Se requiere el uso de las siguientes tecnologías y conceptos:

* **Mix** → estructura del proyecto y gestión de dependencias.
* **GenServer** → cada partida es un proceso concurrente.
* **DynamicSupervisor** → gestión de procesos de partidas activas.
* **Agents** → sesiones de usuarios y caché temporal.
* **Archivos de texto** → persistencia de usuarios, preguntas y resultados.
* **Pruebas unitarias** → programar al menos 5 pruebas con ExUnit.
* **Manejo de errores y excepciones propias** → casos como:

  * Usuario no registrado.
  * Respuesta inválida.
  * Partida llena o ya iniciada.

---

## 🔄 Flujo de Juego – Ejemplo

Se presenta un ejemplo simplificado del flujo de una partida:

1. Pedro y Carlos se conectan al servidor.

2. Pedro crea una partida de **Ciencia**, con 5 preguntas y 15s por pregunta.

3. Carlos se une a la partida.

4. El sistema anuncia:

   ```
   Pregunta 1: ¿Cuál es el planeta más grande del sistema solar?
   A) Marte   B) Júpiter   C) Saturno   D) Neptuno
   Tiempo: 15 segundos
   ```

5. Pedro responde con `answer 1 B` → Correcto, +10 puntos.

6. Carlos responde con `answer 1 C` → Incorrecto, –5 puntos.

7. Al terminar las 5 preguntas, se muestra el ranking final:

   ```
   Pedro: 40 puntos
   Carlos: -10 puntos
   Ganador: Pedro
   ```

8. El resultado se guarda en `results.log` y se actualizan los puntajes globales.

---

## 📂 Estructura Recomendada de Archivos

Se sugiere la siguiente estructura para el proyecto, pero puede cambiar si lo considera necesario:

```
proyecto_trivia/
│── lib/
│   ├── trivia/
│   │   ├── server.ex        # Servidor principal
│   │   ├── game.ex          # Lógica de partida (GenServer)
│   │   ├── supervisor.ex    # DynamicSupervisor de partidas
│   │   ├── user_manager.ex  # Gestión de usuarios
│   │   └── question_bank.ex # Manejo de preguntas
│── data/
│   ├── users.dat
│   ├── questions.dat
│   └── results.log
│── test/
│── mix.exs
```